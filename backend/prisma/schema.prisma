generator client {
  provider  = "prisma-client-py"
  interface = "asyncio"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Barangay {
  id         Int       @id @default(autoincrement())
  name       String
  municipality String
  province   String
  latitude   Float?
  longitude  Float?
  hazards    HazardData[]
  createdAt  DateTime  @default(now())
  updatedAt  DateTime  @updatedAt
}

enum HazardType {
  FLOOD
  LANDSLIDE
  STORM_SURGE
  WIND
  EARTHQUAKE
}

model HazardData {
  id         Int         @id @default(autoincrement())
  type       HazardType
  severity   Int         @default(1) // 1-5 scale
  // GeoJSON geometry (Polygon, MultiPolygon, Point)
  geometry   Json
  // Additional metadata
  source     String?     // e.g., "PAGASA", "LIPAD", "UP_NOAH"
  confidence Float?      // 0.0-1.0
  elevation  Float?      // meters above sea level
  affectedPopulation Int? // estimated affected people
  barangayId Int?
  barangay   Barangay?   @relation(fields: [barangayId], references: [id])
  createdAt  DateTime    @default(now())
  updatedAt  DateTime    @updatedAt
  @@index([type])
  @@index([barangayId])
}

model EvacuationCenter {
  id         Int       @id @default(autoincrement())
  name       String
  address    String?
  latitude   Float
  longitude  Float
  capacity   Int?
  barangayId Int?
  barangay   Barangay? @relation(fields: [barangayId], references: [id])
  createdAt  DateTime  @default(now())
  updatedAt  DateTime  @updatedAt
}
