generator client {
  provider  = "prisma-client-py"
  interface = "asyncio"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id          Int       @id @default(autoincrement())
  email       String    @unique
  name        String?
  barangayId  Int?
  barangay    Barangay? @relation(fields: [barangayId], references: [id])
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
}

model Barangay {
  id         Int       @id @default(autoincrement())
  name       String
  municipality String
  province   String
  users      User[]
  shelters   Shelter[]
  createdAt  DateTime  @default(now())
  updatedAt  DateTime  @updatedAt
}

model Shelter {
  id         Int       @id @default(autoincrement())
  name       String
  address    String?
  latitude   Float?
  longitude  Float?
  capacity   Int?
  barangayId Int
  barangay   Barangay  @relation(fields: [barangayId], references: [id])
  createdAt  DateTime  @default(now())
  updatedAt  DateTime  @updatedAt
}

enum HazardType {
  FLOOD
  LANDSLIDE
  STORM_SURGE
  WIND
}

model HazardArea {
  id         Int         @id @default(autoincrement())
  type       HazardType
  severity   Int         @default(1)
  // GeoJSON Polygon or MultiPolygon
  geometry   Json
  barangayId Int?
  barangay   Barangay?   @relation(fields: [barangayId], references: [id])
  createdAt  DateTime    @default(now())
  updatedAt  DateTime    @updatedAt
  @@index([type])
}

